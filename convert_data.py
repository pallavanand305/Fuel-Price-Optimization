import pandas as pd

# Raw data as string
data_text = """date	price	cost	comp1_price	comp2_price	comp3_price	volume
2023-01-01	97.66	86.46	98.39	99.1	97.37	13513
2023-01-02	96.46	87.25	95.37	96.25	97.38	13605
2023-01-03	94.67	86.4	94.41	94.69	94.5	16540
2023-01-04	97.32	87.51	99.12	96.9	97.54	14927
2023-01-05	94.08	86.38	93.31	94.61	93.85	13332
2023-01-06	96.73	88.24	97.27	97.17	97.23	13643
2023-01-07	98.63	87.79	98.31	99.22	99.34	13603
2023-01-08	100.89	88	101.76	101.22	101.35	14638
2023-01-09	97.71	88.68	99.49	99.68	97.38	13867
2023-01-10	97.14	89.05	96.02	98.24	96.82	13471
2023-01-11	101.3	88.72	100.1	100.59	101.82	15250
2023-01-12	100.19	86.62	100.81	99.88	98.65	13293
2023-01-13	95.88	86.9	95.49	95.23	94.96	13154
2023-01-14	97.48	87.42	97.87	96.26	97.52	12938
2023-01-15	97.04	87.44	96.18	98.43	97.78	13381
2023-01-16	96.87	87.4	94.87	96.7	97.02	14275
2023-01-17	96.84	86.4	98.17	99.17	96.44	14412
2023-01-18	96.39	86.81	98.05	95.97	97.3	14773
2023-01-19	96.53	86.22	97.42	96.83	97.65	14538
2023-01-20	94.51	86.12	94.03	92.7	94.2	13507
2023-01-21	95.11	85.24	94.37	93.98	94.71	13049
2023-01-22	98.01	85.91	96.11	98.35	98.39	13520
2023-01-23	96.01	85.56	95.42	94.35	95.69	14336
2023-01-24	98.72	85.84	100.18	99.93	98.15	15100
2023-01-25	96.48	86.94	95.69	95.95	96.96	15050
2023-01-26	95.69	85.42	95.4	96.19	95.8	13280
2023-01-27	100.22	87.95	100.08	98.67	99.89	13479
2023-01-28	93.17	86.19	92.92	93.44	93.43	13517
2023-01-29	91.16	86.06	92.47	89.55	92.39	13910
2023-01-30	93.61	85.19	94.24	91.96	93.34	13387
2023-01-31	98.79	86.22	98.5	97.11	98.66	13949
2024-12-30	94.45	85.77	95.01	95.7	95.21	13364"""

# Convert to DataFrame
lines = data_text.strip().split('\n')
data = []
for line in lines[1:]:  # Skip header
    parts = line.split('\t')
    data.append(parts)

df = pd.DataFrame(data, columns=['date', 'price', 'cost', 'comp1_price', 'comp2_price', 'comp3_price', 'volume'])

# Convert numeric columns
numeric_cols = ['price', 'cost', 'comp1_price', 'comp2_price', 'comp3_price', 'volume']
for col in numeric_cols:
    df[col] = pd.to_numeric(df[col])

# Create data directory if it doesn't exist
import os
os.makedirs('data', exist_ok=True)

# Save to CSV
df.to_csv('data/complete_data.csv', index=False)
print(f"Converted {len(df)} records to CSV format")
print(f"Date range: {df['date'].min()} to {df['date'].max()}")